language: node_js

cache: yarn

node_js:
  - 8
  - 10
  - 11
  - 12

jobs:
  include:
    - stage: test
      script: yarn test:prod && yarn build
    - stage: deploy
      node_js:
        - 10
      script:
        - yarn build && yarn report-coverage
        - if [ "$TRAVIS_BRANCH" = "master" -a "$TRAVIS_PULL_REQUEST" = "false" ]; then yarn deploy-docs; fi
        - if [ "$TRAVIS_BRANCH" = "master" -a "$TRAVIS_PULL_REQUEST" = "false" ]; then yarn semantic-release; fi

branches:
  except:
    - /^v\d+\.\d+\.\d+$/
